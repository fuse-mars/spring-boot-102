<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Spring boot - general architecture by fuse-mars</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Spring boot - general architecture</h1>
      <h2 class="project-tagline">spring boot application with a GET and a POST requests </h2>
      <a href="https://github.com/fuse-mars/spring-boot-102" class="btn">View on GitHub</a>
      <a href="https://github.com/fuse-mars/spring-boot-102/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/fuse-mars/spring-boot-102/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h3>
<a id="overview" class="anchor" href="#overview" aria-hidden="true"><span class="octicon octicon-link"></span></a>Overview</h3>

<p>This Article explains step by step how to create a restful spring-boot application</p>

<h3>
<a id="use-case" class="anchor" href="#use-case" aria-hidden="true"><span class="octicon octicon-link"></span></a>Use case</h3>

<p>We are build an application that allows users to store api specifications.</p>

<p>POST url: <code>&lt;host&gt;/api/api-spec</code>
POST request:</p>

<ul>
<li>API = <code>&lt;host&gt;/api</code>
</li>
<li>METHOD = <code>GET, POST, PUT, DELETE</code>
</li>
<li>HEADERS = <code>{Authorization: "", hash: ""}</code>
</li>
<li>QUERY_PARAMS = <code>{userdata: {a: 1, b: 2}}</code>
</li>
</ul>

<p>POST response:</p>

<ul>
<li>Saved object</li>
</ul>

<p>GET url: <code>&lt;host&gt;/api/api-spec/&lt;id&gt;</code>
GET request:</p>

<ul>
<li>ID = <code>object id</code>
</li>
</ul>

<p>GET response:</p>

<ul>
<li>Saved specified by the id</li>
</ul>

<p>Technology:</p>

<ul>
<li><a href="https://gradle.org/">Gradle</a></li>
<li><a href="http://projects.spring.io/spring-boot/">Spring Boot</a></li>
<li><a href="http://projects.spring.io/spring-data/">Spring Data</a></li>
</ul>

<p>Steps followed:</p>

<ul>
<li>create the application structure (on *nix machines)</li>
</ul>

<pre><code>mkdir -p ~/Documents/projects/spring-boot-102/src/main/java/apispec
mkdir -p ~/Documents/projects/spring-boot-102/src/main/resources
mkdir -p ~/Documents/projects/spring-boot-102/src/test
</code></pre>

<ul>
<li>Add a project management tool</li>
</ul>

<pre><code>cd ~/Documents/projects/spring-boot-102
gradle init
</code></pre>

<p><code>gradle init</code> creates the build.gradle. 
After this, we add the project dependencies and other information needed to identify the current projet.</p>

<p>Final build.gradle looks like this.</p>

<pre><code>buildscript {
     repositories {
         mavenCentral()
     }
     dependencies {
         classpath("org.springframework.boot:spring-boot-gradle-plugin:1.2.6.RELEASE")
     }
 }
apply plugin: 'java'
apply plugin: 'idea'
apply plugin: 'spring-boot'

springBoot {
  mainClass = 'apispec.ApiSpecController'
}
jar {
    baseName = 'spring-boot-102'
    version =  '0.0.1'
}

repositories {
    mavenCentral()
}

sourceCompatibility = 1.8
targetCompatibility = 1.8

dependencies {
    compile 'org.springframework.boot:spring-boot-starter-data-rest'
    compile 'org.springframework.boot:spring-boot-starter-data-jpa'
    compile 'com.h2database:h2'

    compile 'org.slf4j:slf4j-api:1.7.12'
    testCompile 'junit:junit:4.12'
}

task wrapper(type: Wrapper) {
    gradleVersion = '2.7'
}
</code></pre>

<ul>
<li>Add data related library dependancies</li>
</ul>

<pre><code>org.springframework.boot:spring-boot-starter-data-rest
org.springframework.boot:spring-boot-starter-data-jpa
</code></pre>

<ul>
<li>Add a model object (this is basically a java class)</li>
</ul>

<pre><code>cd ~/Documents/projects/spring-boot-102
touch src/main/java/apispec/ApiSpec.java
</code></pre>

<pre><code>// ApiSpec.java - model object definition

package apispec;

import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;

@Entity
public class ApiSpec {

    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private long id;
    public long getId() { return id;}

    private String api;
    private String method;
    private String headers;
    private String queryParams;

    public String getApi() { return api;}
    public void setApi(String api) {  this.api = api;}

    public String getMethod() { return method;}
    public void setMethod(String method) { this.method = method;}

    public String getHeaders() {return headers;}
    public void setHeaders(String headers) { this.headers = headers;}

    public String getQueryParams() {return queryParams;}
    public void setQueryParams(String queryParams) {  this.queryParams = queryParams;}

    public ApiSpec(){}
    public ApiSpec(String api, String method, String headers, String queryParams) {
            this.api = api;
            this.method = method;
            this.headers = headers;
            this.queryParams = queryParams;
    }
}
</code></pre>

<ul>
<li>Add a controller class (it is in charge of serving 2 restful API's)</li>
</ul>

<pre><code>cd ~/Documents/projects/spring-boot-102
touch src/main/java/apispec/ApiSpecController.java
</code></pre>

<pre><code>// ApiSpecController.java - controller and application starter/entry point
package apispec;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class ApiSpecController {

  public static void main(String [] arguments){
    SpringApplication.run(ApiSpecController.class, arguments);
  }
}
</code></pre>

<ul>
<li>Add a repository class (it is in charge of data storage)</li>
</ul>

<pre><code>cd ~/Documents/projects/spring-boot-102
touch src/main/java/ApiSpecRepository.java
</code></pre>

<pre><code>// ApiSpecRepository.java - repository for data storage
package apispec;

import java.util.List;

import org.springframework.data.repository.PagingAndSortingRepository;
import org.springframework.data.repository.query.Param;
import org.springframework.data.rest.core.annotation.RepositoryRestResource;

@RepositoryRestResource(collectionResourceRel = "apispec", path = "apispec")
public interface ApiSpecRepository extends PagingAndSortingRepository&lt;ApiSpec, Long&gt; {

    List&lt;ApiSpec&gt; findByApi(@Param("api") String api);

}
</code></pre>

<ul>
<li>Build the application</li>
</ul>

<pre><code>gradle build
</code></pre>

<ul>
<li>Run the application</li>
</ul>

<pre><code>gradle bootRun
</code></pre>

<ul>
<li>Access the application from a web browser</li>
</ul>

<pre><code>http://localhost:8080/apispec
</code></pre>

<p>Resources:</p>

<ul>
<li><a href="https://docs.gradle.org/current/userguide/build_init_plugin.html">https://docs.gradle.org/current/userguide/build_init_plugin.html</a></li>
<li><a href="http://spring.io/guides/gs/accessing-data-rest">http://spring.io/guides/gs/accessing-data-rest</a></li>
</ul>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/fuse-mars/spring-boot-102">Spring boot - general architecture</a> is maintained by <a href="https://github.com/fuse-mars">fuse-mars</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

            <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-68265226-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>
